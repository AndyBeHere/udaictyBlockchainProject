const level = require('level');
const chainDB = './testdata';
const db = level(chainDB, {valueEncoding: 'json'});
const SHA256 = require('crypto-js/sha256');

function addLevelDBData(key,value){
    db.put(key, value, function(err) {
        if (err) return console.log('Block ' + key + ' submission failed', err);
    })
}

function getLevelDBData(key){
    db.get(key, function(err, value) {
        if (err) {return console.log('Not found!', err);}
        console.log('Value = ' + value);
        console.log('Database:');
        console.log('typeof value = ',typeof value);
        console.log(value);
        arr.push(value)
    })
}

class block {
    constructor(data) {
        this.height = 0,
        this.data = data
      }
}

class testChain {
    constructor() {
        addLevelDBData("height", 0);
        console.log("Genesis block height:"+this.getBlockHeight());
        let genesisBlock = new block("First block in the chain - genesis block");
        addLevelDBData(0, genesisBlock);
    }
    addBlock(newBlock) {
        let height = this.getBlockHeight();
        console.log(height);
        newBlock.height = height +1;
        addLevelDBData(newBlock.height, newBlock);
        console.log(newBlock);
        addLevelDBData("height", newBlock.height);
    }
    getBlockHeight(){
        let blockHeight = getLevelDBData("height");
        console.log("blockHeight: "+blockHeight);
        return blockHeight;
    }
}